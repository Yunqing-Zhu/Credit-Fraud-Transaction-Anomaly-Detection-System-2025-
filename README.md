# 信用卡欺诈检测模型

基于随机森林算法的信用卡欺诈检测模型，使用机器学习技术识别潜在的欺诈交易。

## 项目结构

```
card/
├── train_model.py          # 模型训练程序
├── test_model.py           # 模型测试程序
├── run_all.py              # 综合运行脚本
├── download_dataset.py        # 数据下载脚本
├── requirements.txt        # 依赖包列表
└── README.md               # 项目说明文件
```

## 主要功能

- **随机森林模型训练**：使用随机森林算法训练信用卡欺诈检测模型
- **数据预处理**：包括特征标准化、处理类别不平衡问题（SMOTE）
- **超参数优化**：使用网格搜索进行超参数调优
- **模型评估**：计算精确率（Precision）、召回率（Recall）、F1分数和AUC-ROC等指标
- **可视化分析**：生成混淆矩阵、ROC曲线和预测概率分布图
- **模型保存和加载**：支持训练好的模型和预处理器的保存与加载

## 环境准备

### 1. 安装Python依赖

```bash
pip install -r requirements.txt
```

### 2. 下载数据集

```python
import kagglehub

# 下载最新版本
path = kagglehub.dataset_download("mlg-ulb/creditcardfraud")

print("数据集文件路径:", path)
```

请确保在当前目录下有 `creditcard.csv` 数据文件。

## 使用方法

### 1. 训练模型

```bash
python train_model.py
```

这将执行以下步骤：
- 加载数据集
- 数据预处理（标准化、处理类别不平衡）
- 超参数优化
- 模型训练
- 模型评估
- 保存训练好的模型和标准化器

### 2. 测试模型

```bash
python test_model.py
```

这将加载训练好的模型并执行以下步骤：
- 加载测试数据
- 模型评估
- 生成评估指标和可视化图表
- 提供新交易预测示例

### 3. 使用综合运行脚本

```bash
python run_all.py
```

这将提供一个交互式界面，可以：
- 显示使用说明
- 检查环境依赖
- 检查数据文件
- 运行完整流程（训练+测试）
- 单独运行训练或测试

## 评估指标

- **精确率 (Precision)**：预测为欺诈的交易中实际为欺诈的比例
- **召回率 (Recall)**：实际欺诈交易中被正确识别的比例
- **F1分数 (F1-score)**：精确率和召回率的调和平均数
- **AUC-ROC**：ROC曲线下面积，衡量模型区分能力的指标

## 优化策略

1. **处理类别不平衡**：使用SMOTE（Synthetic Minority Oversampling Technique）过采样技术
2. **超参数优化**：使用网格搜索优化随机森林的关键参数
3. **交叉验证**：使用5折交叉验证评估模型性能
4. **特征标准化**：对特征进行标准化处理
5. **类别权重平衡**：在模型中设置balanced class weight

## 数据集说明

信用卡欺诈检测数据集包含匿名化的信用卡交易数据，其中包含正常交易和欺诈交易。目标是训练一个模型来识别潜在的欺诈交易。

- 特征：V1-V28（匿名化特征）、Time（交易时间）、Amount（交易金额）
- 标签：Class（0表示正常，1表示欺诈）